{"remainingRequest":"/Users/sthembisomashiyane/WebstormProjects/dripy/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/sthembisomashiyane/WebstormProjects/dripy/src/components/ShoppingCart.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/sthembisomashiyane/WebstormProjects/dripy/src/components/ShoppingCart.vue","mtime":1587899242304},{"path":"/Users/sthembisomashiyane/WebstormProjects/dripy/node_modules/cache-loader/dist/cjs.js","mtime":1587899238127},{"path":"/Users/sthembisomashiyane/WebstormProjects/dripy/node_modules/babel-loader/lib/index.js","mtime":1587899237742},{"path":"/Users/sthembisomashiyane/WebstormProjects/dripy/node_modules/cache-loader/dist/cjs.js","mtime":1587899238127},{"path":"/Users/sthembisomashiyane/WebstormProjects/dripy/node_modules/vue-loader/lib/index.js","mtime":1587899242029}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAgbWFwQWN0aW9ucywKICBtYXBHZXR0ZXJzCn0gZnJvbSAndnVleCc7CmltcG9ydCBDYXJ0SXRlbSBmcm9tICcuL2NhcnQvQ2FydEl0ZW0udnVlJzsKZXhwb3J0IGRlZmF1bHQgewogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBHZXR0ZXJzKFsnY2FydEl0ZW1MaXN0JywgJ2lzTG9nZ2VkSW4nLCAncHJvZHVjdHMnLCAnY3VycmVudFVzZXInLCAnY2FydFZhbHVlJ10pCiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBhcHBDYXJ0SXRlbTogQ2FydEl0ZW0KICB9LAogIG1ldGhvZHM6IHsKICAgIC4uLm1hcEFjdGlvbnMoWydzYXZlU2hvcHBpbmdDYXJ0JywgJ2FkZE1lc3NhZ2UnLCAnc2F2ZVRvVHJhbnNhY3Rpb24nLCAnY2xlYXJDYXJ0J10pLAogICAgY2hlY2tWYWxpZENhcnQoaXRlbUxpc3QsIHByb2RMaXN0KSB7CiAgICAgIGxldCBpc1ZhbGlkID0gdHJ1ZTsKICAgICAgbGV0IG1lc3NhZ2UgPSAiIjsKCiAgICAgIGl0ZW1MaXN0Lm1hcChpdGVtID0+IHsKICAgICAgICBmb3IgKGxldCBwcm9kSWR4ID0gMDsgcHJvZElkeCA8IHByb2RMaXN0Lmxlbmd0aDsgcHJvZElkeCsrKSB7CiAgICAgICAgICBpZiAocHJvZExpc3RbcHJvZElkeF0uaWQgPT0gaXRlbS5pZCkgewogICAgICAgICAgICBpZiAocHJvZExpc3RbcHJvZElkeF0ucXVhbnRpdHkgPCBpdGVtLnF1YW50aXR5KSB7CiAgICAgICAgICAgICAgbWVzc2FnZSA9IGBPbmx5ICR7cHJvZExpc3RbcHJvZElkeF0ucXVhbnRpdHl9ICR7aXRlbS50aXRsZX0gYXZhaWxhYmxlIGluIHN0b2NrYDsKICAgICAgICAgICAgICBpc1ZhbGlkID0gZmFsc2U7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiB7CiAgICAgICAgaXNWYWxpZCwKICAgICAgICBtZXNzYWdlCiAgICAgIH0KICAgIH0sCiAgICBzYXZlU2hvcHBpbmdDYXJ0TG9jYWwoKSB7CiAgICAgIGlmICh0aGlzLmlzTG9nZ2VkSW4pIHsKICAgICAgICBsZXQgewogICAgICAgICAgaXNWYWxpZCwKICAgICAgICAgIG1lc3NhZ2UKICAgICAgICB9ID0gdGhpcy5jaGVja1ZhbGlkQ2FydCh0aGlzLmNhcnRJdGVtTGlzdCwgdGhpcy5wcm9kdWN0cyk7CgogICAgICAgIGlmIChpc1ZhbGlkKSB7CiAgICAgICAgICB0aGlzLnNhdmVTaG9wcGluZ0NhcnQoewogICAgICAgICAgICBjYXJ0SXRlbUxpc3Q6IHRoaXMuY2FydEl0ZW1MaXN0LAogICAgICAgICAgICB1aWQ6IHRoaXMuY3VycmVudFVzZXIudWlkCiAgICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgICAgdGhpcy5hZGRNZXNzYWdlKHsKICAgICAgICAgICAgICBtZXNzYWdlQ2xhc3M6ICdzdWNjZXNzJywKICAgICAgICAgICAgICBtZXNzYWdlOiAnWW91ciBzaG9wcGluZyBjYXJ0IGlzIHNhdmVkIHN1Y2Nlc3NmdWxseScKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvJyk7CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5hZGRNZXNzYWdlKHsKICAgICAgICAgICAgbWVzc2FnZUNsYXNzOiAnZGFuZ2VyJywKICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYWRkTWVzc2FnZSh7CiAgICAgICAgICBtZXNzYWdlQ2xhc3M6ICd3YXJuaW5nJywKICAgICAgICAgIG1lc3NhZ2U6ICdQbGVhc2UgbG9naW4gdG8gc2F2ZSB5b3VyIGNhcnQnCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBjaGVja291dCgpIHsKICAgICAgaWYgKHRoaXMuaXNMb2dnZWRJbikgewogICAgICAgIGlmICghdGhpcy5jYXJ0SXRlbUxpc3QgfHwgdGhpcy5jYXJ0SXRlbUxpc3QubGVuZ3RoID09IDApIHsKICAgICAgICAgIHRoaXMuYWRkTWVzc2FnZSh7CiAgICAgICAgICAgIG1lc3NhZ2VDbGFzczogJ3dhcm5pbmcnLAogICAgICAgICAgICBtZXNzYWdlOiAnWW91ciBjYXJ0IGlzIGVtcHR5IScKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBsZXQgewogICAgICAgICAgaXNWYWxpZCwKICAgICAgICAgIG1lc3NhZ2UKICAgICAgICB9ID0gdGhpcy5jaGVja1ZhbGlkQ2FydCh0aGlzLmNhcnRJdGVtTGlzdCwgdGhpcy5wcm9kdWN0cyk7CgogICAgICAgIGlmIChpc1ZhbGlkKSB7CiAgICAgICAgICB0aGlzLnNhdmVUb1RyYW5zYWN0aW9uKHsKICAgICAgICAgICAgY2FydEl0ZW1MaXN0OiB0aGlzLmNhcnRJdGVtTGlzdCwKICAgICAgICAgICAgdWlkOiB0aGlzLmN1cnJlbnRVc2VyLnVpZAogICAgICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgICAgIHRoaXMuYWRkTWVzc2FnZSh7CiAgICAgICAgICAgICAgbWVzc2FnZUNsYXNzOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgbWVzc2FnZTogJ1lvdXIgb3JkZXIgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IHByb2Nlc3NlZCEnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLnNhdmVTaG9wcGluZ0NhcnQoewogICAgICAgICAgICAgIGNhcnRJdGVtTGlzdDogW10sCiAgICAgICAgICAgICAgdWlkOiB0aGlzLmN1cnJlbnRVc2VyLnVpZAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy5jbGVhckNhcnQoKTsKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy8nKTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmFkZE1lc3NhZ2UoewogICAgICAgICAgICBtZXNzYWdlQ2xhc3M6ICdkYW5nZXInLAogICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5hZGRNZXNzYWdlKHsKICAgICAgICAgIG1lc3NhZ2VDbGFzczogJ3dhcm5pbmcnLAogICAgICAgICAgbWVzc2FnZTogJ1BsZWFzZSBsb2dpbiB0byBjaGVja291dCcKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["ShoppingCart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ShoppingCart.vue","sourceRoot":"src/components","sourcesContent":["<template>\n<div class=\"container table-responsive\">\n  <table id=\"cart\" class=\"table table-hover table-sm\">\n    <thead>\n      <tr>\n        <th style=\"width:50%\">Product</th>\n        <th style=\"width:10%\">Price</th>\n        <th style=\"width:8%\">Quantity</th>\n        <th style=\"width:22%\" class=\"text-center\">Subtotal</th>\n        <th style=\"width:10%\"></th>\n      </tr>\n    </thead>\n\n    <transition-group name=\"list-shopping-cart\" tag=\"tbody\">\n      <app-cart-item v-for=\"cartItem in cartItemList\" :cartItem=\"cartItem\" :key=\"cartItem.id\"></app-cart-item>\n    </transition-group>\n\n    <tfoot>\n      <tr class=\"d-table-row d-sm-none\">\n        <td class=\"text-center\"><strong>Total ${{ cartValue }}</strong></td>\n      </tr>\n      <tr>\n        <td>\n          <button class=\"btn btn-warning\" @click=\"saveShoppingCartLocal\">\n\t\t\t\t\t\t\t<i class=\"fa fa-angle-left\"></i> Save and Continue Shopping\n\t\t\t\t\t\t</button>\n        </td>\n        <td colspan=\"2\" class=\"d-none d-sm-table-cell\"></td>\n        <td class=\"d-none d-sm-table-cell text-center\"><strong>Total ${{ cartValue }}</strong></td>\n        <td class=\"px-0\">\n          <button class=\"btn btn-success\" @click=\"checkout\">\n\t\t\t\t\t\t\t<span class=\"text-nowrap\">Checkout <i class=\"fa fa-angle-right d-inline\"></i></span>\n\t\t\t\t\t</button>\n        </td>\n      </tr>\n    </tfoot>\n  </table>\n</div>\n</template>\n\n<script>\nimport {\n  mapActions,\n  mapGetters\n} from 'vuex';\nimport CartItem from './cart/CartItem.vue';\nexport default {\n  computed: {\n    ...mapGetters(['cartItemList', 'isLoggedIn', 'products', 'currentUser', 'cartValue'])\n  },\n  components: {\n    appCartItem: CartItem\n  },\n  methods: {\n    ...mapActions(['saveShoppingCart', 'addMessage', 'saveToTransaction', 'clearCart']),\n    checkValidCart(itemList, prodList) {\n      let isValid = true;\n      let message = \"\";\n\n      itemList.map(item => {\n        for (let prodIdx = 0; prodIdx < prodList.length; prodIdx++) {\n          if (prodList[prodIdx].id == item.id) {\n            if (prodList[prodIdx].quantity < item.quantity) {\n              message = `Only ${prodList[prodIdx].quantity} ${item.title} available in stock`;\n              isValid = false;\n              return;\n            }\n            break;\n          }\n        }\n      });\n      return {\n        isValid,\n        message\n      }\n    },\n    saveShoppingCartLocal() {\n      if (this.isLoggedIn) {\n        let {\n          isValid,\n          message\n        } = this.checkValidCart(this.cartItemList, this.products);\n\n        if (isValid) {\n          this.saveShoppingCart({\n            cartItemList: this.cartItemList,\n            uid: this.currentUser.uid\n          }).then(() => {\n            this.addMessage({\n              messageClass: 'success',\n              message: 'Your shopping cart is saved successfully'\n            });\n            this.$router.push('/');\n          });\n        } else {\n          this.addMessage({\n            messageClass: 'danger',\n            message: message\n          });\n        }\n      } else {\n        this.addMessage({\n          messageClass: 'warning',\n          message: 'Please login to save your cart'\n        });\n      }\n    },\n    checkout() {\n      if (this.isLoggedIn) {\n        if (!this.cartItemList || this.cartItemList.length == 0) {\n          this.addMessage({\n            messageClass: 'warning',\n            message: 'Your cart is empty!'\n          });\n          return;\n        }\n        let {\n          isValid,\n          message\n        } = this.checkValidCart(this.cartItemList, this.products);\n\n        if (isValid) {\n          this.saveToTransaction({\n            cartItemList: this.cartItemList,\n            uid: this.currentUser.uid\n          }).then(() => {\n            this.addMessage({\n              messageClass: 'success',\n              message: 'Your order has been successfully processed!'\n            });\n            this.saveShoppingCart({\n              cartItemList: [],\n              uid: this.currentUser.uid\n            });\n            this.clearCart();\n            this.$router.push('/');\n          });\n        } else {\n          this.addMessage({\n            messageClass: 'danger',\n            message: message\n          });\n        }\n      } else {\n        this.addMessage({\n          messageClass: 'warning',\n          message: 'Please login to checkout'\n        });\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.list-shopping-cart-leave-active {\n  transition: all 0.4s;\n}\n\n.list-shopping-cart-leave-to {\n  opacity: 0;\n  transform: translateX(50px);\n}\n\n.table-sm {\n  font-size: 0.875rem;\n  /deep/ h4 {\n    font-size: 1.25rem;\n  }\n}\n</style>\n"]}]}